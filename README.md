# Проектная работа "Веб-ларек"

Ссылка на репозиторий: [тык](https://github.com/qFlensT/web-larek-frontend)

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- `src/` — исходные файлы проекта
- `src/components/` — папка с JS компонентами
- `src/components/base/` — папка с базовым кодом
- `src/components/common` - папка с компонентами не привязанными к конкретному проекту (легко переносимые)
- `src/components/model` - папка с бизнес логикой, в данном случае с логикой взаимодействия с сервером
- `src/components/view` - папка с компонентами привязанными конкретно к этому проеку и не имеющие логики обработки своего состояния

Важные файлы:

- `src/pages/index.html` — HTML-файл главной страницы
- `src/index.ts` — точка входа приложения, выполняющая функцию контроллера
- `src/styles/styles.scss` — корневой файл стилей
- `src/utils/constants.ts` — файл с константами
- `src/utils/utils.ts` — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

### Использующийся паттерн

В данном проекте используется паттерн **MVC**, без явного указания контроллера, т.к. из-за небольших размеров приложения используется один общий, который расположен по пути `/src/index.ts`, он же является точкой входа в приложение.

### Базовые компоненты

Данные компоненты не привязаны к конкретному приложению и их можно легко переносить между проектами.
Путь: `src/components/base/`

#### В проекте представлены следующие базовые компоненты:

- `Api` - компонент взаимодействия с `API`
- `Component` - компонент описывающий базовую логику графического компонента, представлен в виде _абстрактного класса_.
- `Events` - компонент реализующий паттерн `Observer`

`Api` и `Component` используются только в виде других компонентов, которые произвели наследование от них при помощи ключевого слова `extends`. `Events` в свою очередь используется в проекте как самостоятельная единица.

> Все типы, требующиеся для работы каждого конкретного компонента находятся в файле самого компонента, для лучшей переносимости между проектами.
> **Отсутствуют кросс-импорты.**

### "Общие" (common) компоненты

Компоненты, которые унаследовались от _базового компонента_ `Component`, и представляют из себя что-то среднее между базовыми компонентами по их сути, и компонентами из `View`, речь о которых пойдет далее. Данные компоненты не включают в себя какую-либо логику или собственное управление состоянием, так же у них привязки к конкретному элементу в `HTML` документе на основе которого они будут строится и искать дочерние теги посредством поиска через селектор, вместо этого они принимают `container` - `HTML` элемент на основе которого они будут строится.

Каждый компоненты имеет собственные _пропсы_ - опциональные свойства, на основе которых меняется внутренее состояние компонента, а так же _действия (actions)_ - опциональный объект, куда помещаются _коллбеки_, которые срабатывают при взаимодействии с интерактивными элементами компонента.

Путь: `src/components/common/`

#### Все "Общие" компоненты

- `Card` - карточка, имеет возможность расширения _пропсы_
- `Form` - форма
- `Modal` - модальное окно
- `Success` - компонент успешной покупки
- `/Basket/Basket` - компонент корзины
- `/Basket/BasketItem` - компонент элемента корзины

> Все типы, требующиеся для работы каждого конкретного компонента находятся в файле самого компонента, для лучшей переносимости между проектами.
> **Отсутствуют кросс-импорты.**

### View

В данной категории распологаются компоненты с жесткой привязкой к текущей задаче, все они наследуются от соответствующих `common` компонентов, и сами находят необходимый элемент в `DOM-дереве`, для последующей передачи в _родительский класс_, а так же модифицируют поведение, дабы соответствовать требованиям текущей задачи.
В качестве аргументов каждый компонент из `View` требует объект _имплиментирующий_ интерфейс `IEvents`, расположенный в базовом `Observer-компоненте` `Events`, таким образом каждый компонент заменяет _колбеки_ на общий событийный объект. Эти компоненты так же не имеют контроля над собственным состоянием, а принимают его через _пропсы_.

Путь: `src/components/view/`

#### Все View компоненты

- `CatalogItemView` - карточка товара не имеющая описаний и находящаяся в каталоге, наследуется от `Card`
- `CatalogItemPreviewView` - карточка товара с описанием отображающаяся в _модальном окне_ при нажатии на конкретный `CatalogItemView`, наследуется от `Card`
- `ModalView` - общее модальное окно, наследуется от `Modal`
- `SuccessView` - компонент успешной покупки, наследуется от `Success`
- `/Basket/BasketView` - компонент корзины, наследуется от `Basket`
- `/Basket/BasketItemView` - компонент элемента корзины, наследуется от `BasketItem`.

> Все типы, требующиеся для работы каждого конкретного компонента находятся в файле самого компонента, для лучшей переносимости между проектами.
> **Отсутствуют кросс-импорты.**

### Model

Сдесь описана логика взаимодействия с сервером при помощи классов `CatalogApi` и `OrderApi`, которые в свою очередь _унаследовались_ от базового компонента `Api`.

Путь: `src/components/model/`

> Все типы, требующиеся для работы каждого конкретного компонента находятся в файле самого компонента, для лучшей переносимости между проектами.
> **Отсутствуют кросс-импорты.**

### Controller

Как и упоминалось раньше в качестве общего _контроллера_ для всех компонентов используется корневой файл `index.ts`. Он контроллирует состояние каждого компонента, а так же связывает воедино `Model` и `View`.
Было принято решение не создавать для каждого отдельного компонента из `View` свой `Controller`, так как показалось что это было бы слишком для такого небольшого проекта.

### Краткая схема организации модулей внутри проекта

![Схема организации кода](./Project_scheme.png 'Схема организации кода')

### Таблица событий

| Событие                    | Передаваемые данные                                      | Описание                                                                                          |
|----------------------------|----------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| catalogItem:click          |                      { id: string }                      | Срабатывает при клике на товар из каталога                                                        |
| catalogItem:addToCartClick |                      { id: string }                      | Срабатывает при клике на  кнопку "Добавить в корзину"                                             |
| modal:open                 |                             -                            | Срабатывает при открытии модального окна                                                          |
| modal:close                |                             -                            | Срабатывает при закрытии модального окна                                                          |
| order:change               | { address: string } | { paymentType: "online" | "cash" } | Срабатывает при взаимодействии с формой Order                                                     |
| order:submit               |                             -                            | Срабатывает при отправке формы Order                                                              |
| contacts:change            |           { email: string } | { phone: string}           | Срабатывает при взаимодействии с формой Contacts                                                  |
| contacts:submit            |                             -                            | Срабатывает при отправке формы Contacts                                                           |
| basket:buy                 |                             -                            | Срабатывает при нажатии кнопки "Оформить" в корзине                                               |
| basketItem:delete          |                      { id: string }                      | Срабатывает при удалении товара из корзины                                                        |
| success:click              |                             -                            | Срабатывает при нажатии на кнопку "За новыми покупками!" у компонента успешного оформления товара |

## Дополнительная информация

Из-за отсутствия _кросс-импортов_ в проекте, было принято решение не создавать общий файл с типами `types.ts`.
